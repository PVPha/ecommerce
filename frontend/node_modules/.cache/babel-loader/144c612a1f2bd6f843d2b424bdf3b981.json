{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\freelancerCoder\\\\Ecommerce\\\\frontend\\\\src\\\\components\\\\admin\\\\Dashboard\\\\News\\\\DashboardNewsEdit.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\";\nimport axios from \"axios\";\nimport DashboardEditor from \"./DashboardEditor\";\nexport default function DashboardNewsCreate(props) {\n  const createForm = useRef();\n  const cateInput = useRef();\n  const [inputValue, setInputValue] = useState([]);\n  const [file, setFile] = useState([]);\n  const [cateList, setCateList] = useState([]);\n  const news = props.news;\n\n  const handleOnChange = event => {\n    setInputValue({ ...inputValue,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const [newsTitle, setNewsTitle] = useState(\"\");\n  const [newsImg, setNewsImg] = useState([]);\n  const [newsCate, setNewsCate] = useState(\"\");\n  const [newsContent, setNewsContent] = useState(\"\");\n  useEffect(() => {\n    if (news) {\n      setNewsTitle(news.newTitle);\n      setNewsImg([news.newImg]);\n      setNewsCate(news.newCate);\n      setNewsContent(news.newContent);\n      axios.get(`http://localhost:4000/news`).then(res => {\n        const test = Object.values(res.data.reduce((a, {\n          newCate\n        }) => {\n          a[newCate] = a[newCate] || {\n            newCate\n          };\n          return a;\n        }, Object.create(null)));\n        setCateList(test);\n      });\n    }\n  }, [news]);\n\n  const onSubmit = event => {\n    event.preventDefault();\n    const config = {\n      headers: {\n        \"content-type\": \"multipart/form-data\"\n      }\n    };\n    const formData = new FormData();\n    const imageArr = Array.from(file);\n    imageArr.forEach(image => {\n      formData.append(\"newImg\", image);\n    });\n    formData.append(\"newCate\", newsCate);\n    formData.append(\"newTitle\", newsTitle);\n    formData.append(\"newContent\", newsContent);\n    axios.post(`http://localhost:4000/news/update/${news._id}`, formData, config).then(() => {\n      props.setCloseEditFunc(false);\n      props.setToastFunc(true);\n    });\n  };\n\n  const addNewCate = () => {\n    setCateList(cateList => [...cateList, {\n      newCate: inputValue.cate\n    }]);\n    cateInput.current.value = \"\";\n  };\n\n  const deleteImg = event => {\n    const id = event.target.id;\n    const virutalFile = [...file];\n    virutalFile.splice(id, 1);\n    setFile(virutalFile);\n    const items = [...newsImg];\n    items.splice(id, 1);\n    setNewsImg(items);\n    axios.post(`http://localhost:4000/news/update/${news._id}`, {\n      deleteImgId: id\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"DashboardProductInfo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-title flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-title-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, \"News infomation\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-title-close flex-center\",\n    onClick: () => {\n      props.setCloseEditFunc(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faTimes,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: onSubmit,\n    encType: \"multipart/form-data\",\n    ref: createForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-row flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-left flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, \"Title\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"title\",\n    value: newsTitle || \"\",\n    onChange: event => {\n      setNewsTitle(event.target.value);\n    },\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-row flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-left flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, \"Images \"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: event => {\n      const files = event.target.files;\n\n      for (let i = 0; i < files.length; i++) {\n        setNewsImg(news => [...news, URL.createObjectURL(files[i])]);\n      }\n\n      const fileArr = Array.prototype.slice.call(files);\n      fileArr.forEach(item => {\n        setFile(file => [...file, item]);\n      });\n    },\n    type: \"file\",\n    name: \"newsImg\",\n    className: \"noborder\",\n    multiple: \"multiple\",\n    style: {\n      height: \"50px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    style: {\n      overflowY: \"hidden\",\n      flexWrap: \"wrap\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 15\n    }\n  }, newsImg && newsImg.map((item, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      className: \"create-box-img\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      key: index,\n      src: typeof item != \"undefined\" ? item.slice(0, 4) != \"blob\" ? \"data:image/png;base64,\" + item : item : \"\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"create-box-img-overlay\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      id: index,\n      onClick: deleteImg,\n      className: \"icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 27\n      }\n    }, \"X\")));\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"create-box-row flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-left flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }\n  }, \"Category \"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dashboard-right flex-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    style: {\n      width: \"350px\"\n    },\n    onChange: event => {\n      setNewsCate(event.target.value);\n    },\n    value: newsCate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }), cateList.length > 0 && cateList.map((item, index) => {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 28\n      }\n    }, item.newCate);\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"cate\",\n    placeholder: \"New category?\",\n    style: {\n      margin: \"0 10px\"\n    },\n    onChange: handleOnChange,\n    ref: cateInput,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"btn\",\n    style: {\n      fontSize: \"14px\",\n      fontFamily: \"sans-serif\",\n      fontWeight: \"300\",\n      padding: \"0 10px\",\n      cursor: \"pointer\",\n      width: \"350px\",\n      height: \"30px\"\n    },\n    onClick: addNewCate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 15\n    }\n  }, \"Add\"))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      border: \"1px #ddd solid\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(DashboardEditor, {\n    newsContent: newsContent,\n    setNewsContent: setNewsContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-center\",\n    style: {\n      marginTop: \"40px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"create-box-btn btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }, \"Edit news\")))));\n}","map":{"version":3,"sources":["C:/Users/Admin/Desktop/freelancerCoder/Ecommerce/frontend/src/components/admin/Dashboard/News/DashboardNewsEdit.js"],"names":["React","useEffect","useRef","useState","FontAwesomeIcon","faTimes","axios","DashboardEditor","DashboardNewsCreate","props","createForm","cateInput","inputValue","setInputValue","file","setFile","cateList","setCateList","news","handleOnChange","event","target","name","value","newsTitle","setNewsTitle","newsImg","setNewsImg","newsCate","setNewsCate","newsContent","setNewsContent","newTitle","newImg","newCate","newContent","get","then","res","test","Object","values","data","reduce","a","create","onSubmit","preventDefault","config","headers","formData","FormData","imageArr","Array","from","forEach","image","append","post","_id","setCloseEditFunc","setToastFunc","addNewCate","cate","current","deleteImg","id","virutalFile","splice","items","deleteImgId","files","i","length","URL","createObjectURL","fileArr","prototype","slice","call","item","height","overflowY","flexWrap","map","index","width","margin","fontSize","fontFamily","fontWeight","padding","cursor","border","marginTop"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAASC,eAAT,QAAgC,gCAAhC;AACA,SAASC,OAAT,QAAwB,mCAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AAEA,eAAe,SAASC,mBAAT,CAA6BC,KAA7B,EAAoC;AACjD,QAAMC,UAAU,GAAGR,MAAM,EAAzB;AACA,QAAMS,SAAS,GAAGT,MAAM,EAAxB;AACA,QAAM,CAACU,UAAD,EAAaC,aAAb,IAA8BV,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACW,IAAD,EAAOC,OAAP,IAAkBZ,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACa,QAAD,EAAWC,WAAX,IAA0Bd,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAMe,IAAI,GAAGT,KAAK,CAACS,IAAnB;;AAEA,QAAMC,cAAc,GAAIC,KAAD,IAAW;AAChCP,IAAAA,aAAa,CAAC,EAAE,GAAGD,UAAL;AAAiB,OAACQ,KAAK,CAACC,MAAN,CAAaC,IAAd,GAAqBF,KAAK,CAACC,MAAN,CAAaE;AAAnD,KAAD,CAAb;AACD,GAFD;;AAIA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BtB,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM,CAACuB,OAAD,EAAUC,UAAV,IAAwBxB,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACyB,QAAD,EAAWC,WAAX,IAA0B1B,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC2B,WAAD,EAAcC,cAAd,IAAgC5B,QAAQ,CAAC,EAAD,CAA9C;AAEAF,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIiB,IAAJ,EAAU;AACRO,MAAAA,YAAY,CAACP,IAAI,CAACc,QAAN,CAAZ;AACAL,MAAAA,UAAU,CAAC,CAACT,IAAI,CAACe,MAAN,CAAD,CAAV;AACAJ,MAAAA,WAAW,CAACX,IAAI,CAACgB,OAAN,CAAX;AAEAH,MAAAA,cAAc,CAACb,IAAI,CAACiB,UAAN,CAAd;AACA7B,MAAAA,KAAK,CAAC8B,GAAN,CAAW,4BAAX,EAAwCC,IAAxC,CAA8CC,GAAD,IAAS;AACpD,cAAMC,IAAI,GAAGC,MAAM,CAACC,MAAP,CACXH,GAAG,CAACI,IAAJ,CAASC,MAAT,CAAgB,CAACC,CAAD,EAAI;AAAEV,UAAAA;AAAF,SAAJ,KAAoB;AAClCU,UAAAA,CAAC,CAACV,OAAD,CAAD,GAAaU,CAAC,CAACV,OAAD,CAAD,IAAc;AAAEA,YAAAA;AAAF,WAA3B;AACA,iBAAOU,CAAP;AACD,SAHD,EAGGJ,MAAM,CAACK,MAAP,CAAc,IAAd,CAHH,CADW,CAAb;AAMA5B,QAAAA,WAAW,CAACsB,IAAD,CAAX;AACD,OARD;AASD;AACF,GAjBQ,EAiBN,CAACrB,IAAD,CAjBM,CAAT;;AAmBA,QAAM4B,QAAQ,GAAI1B,KAAD,IAAW;AAC1BA,IAAAA,KAAK,CAAC2B,cAAN;AACA,UAAMC,MAAM,GAAG;AACbC,MAAAA,OAAO,EAAE;AACP,wBAAgB;AADT;AADI,KAAf;AAMA,UAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACA,UAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAN,CAAWxC,IAAX,CAAjB;AACAsC,IAAAA,QAAQ,CAACG,OAAT,CAAkBC,KAAD,IAAW;AAC1BN,MAAAA,QAAQ,CAACO,MAAT,CAAgB,QAAhB,EAA0BD,KAA1B;AACD,KAFD;AAGAN,IAAAA,QAAQ,CAACO,MAAT,CAAgB,SAAhB,EAA2B7B,QAA3B;AACAsB,IAAAA,QAAQ,CAACO,MAAT,CAAgB,UAAhB,EAA4BjC,SAA5B;AACA0B,IAAAA,QAAQ,CAACO,MAAT,CAAgB,YAAhB,EAA8B3B,WAA9B;AACAxB,IAAAA,KAAK,CACFoD,IADH,CACS,qCAAoCxC,IAAI,CAACyC,GAAI,EADtD,EACyDT,QADzD,EACmEF,MADnE,EAEGX,IAFH,CAEQ,MAAM;AACV5B,MAAAA,KAAK,CAACmD,gBAAN,CAAuB,KAAvB;AACAnD,MAAAA,KAAK,CAACoD,YAAN,CAAmB,IAAnB;AACD,KALH;AAMD,GAtBD;;AAwBA,QAAMC,UAAU,GAAG,MAAM;AACvB7C,IAAAA,WAAW,CAAED,QAAD,IAAc,CAAC,GAAGA,QAAJ,EAAc;AAAEkB,MAAAA,OAAO,EAAEtB,UAAU,CAACmD;AAAtB,KAAd,CAAf,CAAX;AACApD,IAAAA,SAAS,CAACqD,OAAV,CAAkBzC,KAAlB,GAA0B,EAA1B;AACD,GAHD;;AAKA,QAAM0C,SAAS,GAAI7C,KAAD,IAAW;AAC3B,UAAM8C,EAAE,GAAG9C,KAAK,CAACC,MAAN,CAAa6C,EAAxB;AACA,UAAMC,WAAW,GAAG,CAAC,GAAGrD,IAAJ,CAApB;AACAqD,IAAAA,WAAW,CAACC,MAAZ,CAAmBF,EAAnB,EAAuB,CAAvB;AACAnD,IAAAA,OAAO,CAACoD,WAAD,CAAP;AAEA,UAAME,KAAK,GAAG,CAAC,GAAG3C,OAAJ,CAAd;AACA2C,IAAAA,KAAK,CAACD,MAAN,CAAaF,EAAb,EAAiB,CAAjB;AACAvC,IAAAA,UAAU,CAAC0C,KAAD,CAAV;AACA/D,IAAAA,KAAK,CAACoD,IAAN,CAAY,qCAAoCxC,IAAI,CAACyC,GAAI,EAAzD,EAA4D;AAC1DW,MAAAA,WAAW,EAAEJ;AAD6C,KAA5D;AAGD,GAZD;;AAcA,sBACE;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAEE;AACE,IAAA,SAAS,EAAC,oCADZ;AAEE,IAAA,OAAO,EAAE,MAAM;AACbzD,MAAAA,KAAK,CAACmD,gBAAN,CAAuB,KAAvB;AACD,KAJH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME,oBAAC,eAAD;AAAiB,IAAA,IAAI,EAAEvD,OAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CAFF,CADF,eAYE;AACE,IAAA,QAAQ,EAAEyC,QADZ;AAEE,IAAA,OAAO,EAAC,qBAFV;AAGE,IAAA,GAAG,EAAEpC,UAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,IAAI,EAAC,OAFP;AAGE,IAAA,KAAK,EAAEc,SAAS,IAAI,EAHtB;AAIE,IAAA,QAAQ,EAAGJ,KAAD,IAAW;AACnBK,MAAAA,YAAY,CAACL,KAAK,CAACC,MAAN,CAAaE,KAAd,CAAZ;AACD,KANH;AAOE,IAAA,QAAQ,MAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAFF,CALF,eAmBE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,QAAQ,EAAGH,KAAD,IAAW;AACnB,YAAMmD,KAAK,GAAGnD,KAAK,CAACC,MAAN,CAAakD,KAA3B;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACE,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC7C,QAAAA,UAAU,CAAET,IAAD,IAAU,CACnB,GAAGA,IADgB,EAEnBwD,GAAG,CAACC,eAAJ,CAAoBJ,KAAK,CAACC,CAAD,CAAzB,CAFmB,CAAX,CAAV;AAID;;AACD,YAAMI,OAAO,GAAGvB,KAAK,CAACwB,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BR,KAA3B,CAAhB;AACAK,MAAAA,OAAO,CAACrB,OAAR,CAAiByB,IAAD,IAAU;AACxBjE,QAAAA,OAAO,CAAED,IAAD,IAAU,CAAC,GAAGA,IAAJ,EAAUkE,IAAV,CAAX,CAAP;AACD,OAFD;AAGD,KAbH;AAcE,IAAA,IAAI,EAAC,MAdP;AAeE,IAAA,IAAI,EAAC,SAfP;AAgBE,IAAA,SAAS,EAAC,UAhBZ;AAiBE,IAAA,QAAQ,EAAC,UAjBX;AAkBE,IAAA,KAAK,EAAE;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAlBT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAqBE;AACE,IAAA,SAAS,EAAC,MADZ;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,SAAS,EAAE,QAAb;AAAuBC,MAAAA,QAAQ,EAAE;AAAjC,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIGzD,OAAO,IACNA,OAAO,CAAC0D,GAAR,CAAY,CAACJ,IAAD,EAAOK,KAAP,KAAiB;AAC3B,wBACE;AAAK,MAAA,GAAG,EAAEA,KAAV;AAAiB,MAAA,SAAS,EAAC,gBAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,GAAG,EAAEA,KADP;AAEE,MAAA,GAAG,EACD,OAAOL,IAAP,IAAe,WAAf,GACIA,IAAI,CAACF,KAAL,CAAW,CAAX,EAAc,CAAd,KAAoB,MAApB,GACE,2BAA2BE,IAD7B,GAEEA,IAHN,GAII,EAPR;AASE,MAAA,GAAG,EAAC,EATN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAYE;AAAK,MAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAG,MAAA,EAAE,EAAEK,KAAP;AAAc,MAAA,OAAO,EAAEpB,SAAvB;AAAkC,MAAA,SAAS,EAAC,MAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WADF,CAZF,CADF;AAoBD,GArBD,CALJ,CArBF,CAFF,CAnBF,eAwEE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,eAEE;AAAK,IAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,KAAK,EAAE;AAAEqB,MAAAA,KAAK,EAAE;AAAT,KADT;AAEE,IAAA,QAAQ,EAAGlE,KAAD,IAAW;AACnBS,MAAAA,WAAW,CAACT,KAAK,CAACC,MAAN,CAAaE,KAAd,CAAX;AACD,KAJH;AAKE,IAAA,KAAK,EAAEK,QALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,EAQGZ,QAAQ,CAACyD,MAAT,GAAkB,CAAlB,IACCzD,QAAQ,CAACoE,GAAT,CAAa,CAACJ,IAAD,EAAOK,KAAP,KAAiB;AAC5B,wBAAO;AAAQ,MAAA,GAAG,EAAEA,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAqBL,IAAI,CAAC9C,OAA1B,CAAP;AACD,GAFD,CATJ,CADF,eAcE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,WAAW,EAAC,eAHd;AAIE,IAAA,KAAK,EAAE;AAAEqD,MAAAA,MAAM,EAAE;AAAV,KAJT;AAKE,IAAA,QAAQ,EAAEpE,cALZ;AAME,IAAA,GAAG,EAAER,SANP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAdF,eAsBE;AACE,IAAA,SAAS,EAAC,KADZ;AAEE,IAAA,KAAK,EAAE;AACL6E,MAAAA,QAAQ,EAAE,MADL;AAELC,MAAAA,UAAU,EAAE,YAFP;AAGLC,MAAAA,UAAU,EAAE,KAHP;AAILC,MAAAA,OAAO,EAAE,QAJJ;AAKLC,MAAAA,MAAM,EAAE,SALH;AAMLN,MAAAA,KAAK,EAAE,OANF;AAOLL,MAAAA,MAAM,EAAE;AAPH,KAFT;AAWE,IAAA,OAAO,EAAEnB,UAXX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAtBF,CAFF,CAxEF,eAiHE;AAAK,IAAA,KAAK,EAAE;AAAE+B,MAAAA,MAAM,EAAE;AAAV,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,eAAD;AACE,IAAA,WAAW,EAAE/D,WADf;AAEE,IAAA,cAAc,EAAEC,cAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAjHF,eAuHE;AAAK,IAAA,SAAS,EAAC,aAAf;AAA6B,IAAA,KAAK,EAAE;AAAE+D,MAAAA,SAAS,EAAE;AAAb,KAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAQ,IAAA,SAAS,EAAC,oBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,CAvHF,CAZF,CADF,CADF;AA4ID","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\";\r\nimport axios from \"axios\";\r\nimport DashboardEditor from \"./DashboardEditor\";\r\n\r\nexport default function DashboardNewsCreate(props) {\r\n  const createForm = useRef();\r\n  const cateInput = useRef();\r\n  const [inputValue, setInputValue] = useState([]);\r\n  const [file, setFile] = useState([]);\r\n  const [cateList, setCateList] = useState([]);\r\n  const news = props.news;\r\n\r\n  const handleOnChange = (event) => {\r\n    setInputValue({ ...inputValue, [event.target.name]: event.target.value });\r\n  };\r\n\r\n  const [newsTitle, setNewsTitle] = useState(\"\");\r\n  const [newsImg, setNewsImg] = useState([]);\r\n  const [newsCate, setNewsCate] = useState(\"\");\r\n  const [newsContent, setNewsContent] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (news) {\r\n      setNewsTitle(news.newTitle);\r\n      setNewsImg([news.newImg]);\r\n      setNewsCate(news.newCate);\r\n\r\n      setNewsContent(news.newContent);\r\n      axios.get(`http://localhost:4000/news`).then((res) => {\r\n        const test = Object.values(\r\n          res.data.reduce((a, { newCate }) => {\r\n            a[newCate] = a[newCate] || { newCate };\r\n            return a;\r\n          }, Object.create(null))\r\n        );\r\n        setCateList(test);\r\n      });\r\n    }\r\n  }, [news]);\r\n\r\n  const onSubmit = (event) => {\r\n    event.preventDefault();\r\n    const config = {\r\n      headers: {\r\n        \"content-type\": \"multipart/form-data\",\r\n      },\r\n    };\r\n\r\n    const formData = new FormData();\r\n    const imageArr = Array.from(file);\r\n    imageArr.forEach((image) => {\r\n      formData.append(\"newImg\", image);\r\n    });\r\n    formData.append(\"newCate\", newsCate);\r\n    formData.append(\"newTitle\", newsTitle);\r\n    formData.append(\"newContent\", newsContent);\r\n    axios\r\n      .post(`http://localhost:4000/news/update/${news._id}`, formData, config)\r\n      .then(() => {\r\n        props.setCloseEditFunc(false);\r\n        props.setToastFunc(true);\r\n      });\r\n  };\r\n\r\n  const addNewCate = () => {\r\n    setCateList((cateList) => [...cateList, { newCate: inputValue.cate }]);\r\n    cateInput.current.value = \"\";\r\n  };\r\n\r\n  const deleteImg = (event) => {\r\n    const id = event.target.id;\r\n    const virutalFile = [...file];\r\n    virutalFile.splice(id, 1);\r\n    setFile(virutalFile);\r\n\r\n    const items = [...newsImg];\r\n    items.splice(id, 1);\r\n    setNewsImg(items);\r\n    axios.post(`http://localhost:4000/news/update/${news._id}`, {\r\n      deleteImgId: id,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"DashboardProductInfo\">\r\n      <div className=\"create-box\">\r\n        <div className=\"create-box-title flex\">\r\n          <div className=\"create-box-title-text\">News infomation</div>\r\n          <div\r\n            className=\"create-box-title-close flex-center\"\r\n            onClick={() => {\r\n              props.setCloseEditFunc(false);\r\n            }}\r\n          >\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </div>\r\n        </div>\r\n        <form\r\n          onSubmit={onSubmit}\r\n          encType=\"multipart/form-data\"\r\n          ref={createForm}\r\n        >\r\n          <div className=\"create-box-row flex\">\r\n            <div className=\"dashboard-left flex\">Title</div>\r\n            <div className=\"dashboard-right\">\r\n              <input\r\n                type=\"text\"\r\n                name=\"title\"\r\n                value={newsTitle || \"\"}\r\n                onChange={(event) => {\r\n                  setNewsTitle(event.target.value);\r\n                }}\r\n                required\r\n              ></input>\r\n            </div>\r\n          </div>\r\n          <div className=\"create-box-row flex\">\r\n            <div className=\"dashboard-left flex\">Images </div>\r\n            <div className=\"dashboard-right\">\r\n              <input\r\n                onChange={(event) => {\r\n                  const files = event.target.files;\r\n                  for (let i = 0; i < files.length; i++) {\r\n                    setNewsImg((news) => [\r\n                      ...news,\r\n                      URL.createObjectURL(files[i]),\r\n                    ]);\r\n                  }\r\n                  const fileArr = Array.prototype.slice.call(files);\r\n                  fileArr.forEach((item) => {\r\n                    setFile((file) => [...file, item]);\r\n                  });\r\n                }}\r\n                type=\"file\"\r\n                name=\"newsImg\"\r\n                className=\"noborder\"\r\n                multiple=\"multiple\"\r\n                style={{ height: \"50px\" }}\r\n              ></input>\r\n              <div\r\n                className=\"flex\"\r\n                style={{ overflowY: \"hidden\", flexWrap: \"wrap\" }}\r\n              >\r\n                {newsImg &&\r\n                  newsImg.map((item, index) => {\r\n                    return (\r\n                      <div key={index} className=\"create-box-img\">\r\n                        <img\r\n                          key={index}\r\n                          src={\r\n                            typeof item != \"undefined\"\r\n                              ? item.slice(0, 4) != \"blob\"\r\n                                ? \"data:image/png;base64,\" + item\r\n                                : item\r\n                              : \"\"\r\n                          }\r\n                          alt=\"\"\r\n                        ></img>\r\n                        <div className=\"create-box-img-overlay\">\r\n                          <p id={index} onClick={deleteImg} className=\"icon\">\r\n                            X\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"create-box-row flex\">\r\n            <div className=\"dashboard-left flex\">Category </div>\r\n            <div className=\"dashboard-right flex-center\">\r\n              <select\r\n                style={{ width: \"350px\" }}\r\n                onChange={(event) => {\r\n                  setNewsCate(event.target.value);\r\n                }}\r\n                value={newsCate}\r\n              >\r\n                <option></option>\r\n                {cateList.length > 0 &&\r\n                  cateList.map((item, index) => {\r\n                    return <option key={index}>{item.newCate}</option>;\r\n                  })}\r\n              </select>\r\n              <input\r\n                type=\"text\"\r\n                name=\"cate\"\r\n                placeholder=\"New category?\"\r\n                style={{ margin: \"0 10px\" }}\r\n                onChange={handleOnChange}\r\n                ref={cateInput}\r\n              ></input>\r\n              <div\r\n                className=\"btn\"\r\n                style={{\r\n                  fontSize: \"14px\",\r\n                  fontFamily: \"sans-serif\",\r\n                  fontWeight: \"300\",\r\n                  padding: \"0 10px\",\r\n                  cursor: \"pointer\",\r\n                  width: \"350px\",\r\n                  height: \"30px\",\r\n                }}\r\n                onClick={addNewCate}\r\n              >\r\n                Add\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div style={{ border: \"1px #ddd solid\" }}>\r\n            <DashboardEditor\r\n              newsContent={newsContent}\r\n              setNewsContent={setNewsContent}\r\n            />\r\n          </div>\r\n          <div className=\"flex-center\" style={{ marginTop: \"40px\" }}>\r\n            <button className=\"create-box-btn btn\">Edit news</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}